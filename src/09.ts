import {Logger, Puzzle} from './lib';
import {spawn} from 'child_process';

//--------------- Main logic
(async () => {
  const logger = new Logger('09');
  const puzzle = new Puzzle('36', logger);

  // Mock Data
  //   const input = `#####################
  // ................#...#
  // ###########.###.#.#.#
  // #...#.......#.#...#.#
  // #.#.#.#######.#####.#
  // #.#..$#.#.$....$....#
  // #.#####.#.#######.###
  // #.#.......#.....#.#.#
  // #.#########.###.#.#.#
  // #.#...........#.#...#
  // #.#.#$####$.###$###.#
  // #...#.....#.#...#...#
  // #.###.###.###.#.#.###
  // #...#.#.....#.#.#...#
  // #####################
  // #.#.#$..#.$...#$..#.#
  // #.#.###.###.#.#.###.#
  // #...#...#...#.....#.#
  // #.###.###.#.#####.#.#
  // #...#.....#..........
  // #####################

  // #####################
  // #.........#.........#
  // #.###.###.#########.#
  // #.......#...........#
  // #######.###########.#
  // #....$#...$....$....#
  // #.###.#####.#######.#
  // #.#.........#.......#
  // #.#####.#.#.#.#####.#
  // #...#...#.#.#.#...#.#
  // ###.#$###.$.#.#$#.#.#
  // #...#.#.#.#...#.#.#.#
  // #.#.#.#.#.###.#.#.#.#
  // #.#.....#.........#.#
  // #.#####.###.#####.#.#
  // #....$#...$.#..$..#.#
  // #.###.#.###.#.#####.#
  // #...#...#.....#.....#
  // ###.#####.#####.#####
  // #.......#...........#
  // #####################`;

  // Real Data
  const input = (await puzzle.getPuzzle()).join('\n');

  // --------------- Process the data.
  logger.log('Processing data...');

  // Use python to use more good memory caching and performance
  const python = spawn('python', [
    'src/09.py',
    Buffer.from(input).toString('base64'),
  ]);

  //--------------- Log the result
  logger.log('===========================================');
  python.stdout.on('data', result => logger.log(result.toString()));
})();
